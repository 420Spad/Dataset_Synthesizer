<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>NVIDIA DeepLearning Dataset Synthesizer (NDDS): Environment</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NVIDIA DeepLearning Dataset Synthesizer (NDDS)
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('environment.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Environment </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
<p> <a class="anchor" id="contents"></a> </p><h1>Contents:</h1>
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#context">Context</a></li>
<li><a href="#usage">DLEnvironment Usage</a></li>
<li><a href="#config">DLEnvironment Configuration Files</a><ul>
<li><a href="#service_config">Service Configuration</a></li>
<li><a href="#instance_config">AI Instance Configuration</a></li>
<li><a href="#substance_config">AI Substance Configuration</a></li>
</ul>
</li>
</ul>
<hr/>
<p> <a class="anchor" id="summary"></a> </p><h1>Summary</h1>
<p>(<a href="#contents">Back to Contents</a>)</p>
<p><b>DLEnvironment</b> provides a library that allows AI instances in an arbitrary C++ environment to be configured and controlled via a remote reinforcement-learning trainer. The DLEnvironment library can be used in stand-alone mode (it is capable of instantiating controlling networks internally), or in conjunction with the DLBroker and DLTrainer processes, to integrate your environment into a scalable training architecture.</p>
<hr/>
<p> <a class="anchor" id="context"></a> </p><h1>Context</h1>
<p>(<a href="#contents">Back to Contents</a>)</p>
<p>The general problem of simulations using reinforcement learning (RL) requires that at each step of the simulation, state data for AI instances can be pushed to a neural network, and that the network return appropriate actions to the AI instances.</p>
<p>Traditionally, this requires strong coupling between the simulation generating state data and the RL networks consuming it. This is less than ideal in a research context, because of platform mismatch between data generation (Windows, for gaming sims for example) and neural-network processing (often unix-based), and also because it makes on-the-fly reconfiguration of sims, or rapid iteration in developing network implementations, difficult at best.</p>
<p><br />
 The DLToolkit includes several components to address these issues: <br />
 <br />
</p>
<p><b>DLEnvironment</b> The DLEnvironment library provides a simple layer allowing for decoupling of data generation and processing, by providing a generic remote interface as a C++ DLL that can be integrated with a simulation to provide the capability to configure AI instances on the fly, and that allows the sim to communicate state data and receive actions from a remote training service. The remote framework uses simple JSON configuration files to specify the trainer IP address and port, and the trainer provides the AI configuration when the sim connects.</p>
<p><b>DLTrainer</b> The DLTrainer codebase provides a general-purpose Python framework for receiving and processing data from multiple sim environments, and batching and routing the data between multiple network implementations. The framework allows network implementations to be written as standalone modules and deployed within the framework, provided they adhere to a simple API. With the remote framework provided by the DLEnvironment library, the trainer can be stopped and restarted and any running sims will automatically reconnect.</p>
<p><b>DLBroker</b> The combination of DLEnvironment and DLTrainer provides a generic <em>many-to-one</em> architecture, allowing many sim environments to send data simultaneously to a single trainer (possibly running multiple network implementations). DLBroker extends this architecture to support <em>many-to-many</em> connections. Trainers and sim environments connect to the broker instead of each other, and the broker handles auto-routing between data generators (sim environments) and data consumers (trainers).</p>
<ul>
<li>This allows many instances of a sim environment to be run without needing separate configuration files for each instance (all environments connect to the same broker, instead of to separate trainers)</li>
<li>Allows the broker to automatically handle routing of data between simulation environments and the trainers that can consume them.</li>
<li>Allows the broker to balance data distribution among connected trainers.</li>
<li>Allows sim data to be forwarded to multiple trainers (i.e., for supervised learning applications, or separate control of AI instances by different servers)</li>
</ul>
<p><br />
 In the context of the DLToolkit components, DLTrainer's role is indicated schematically below:</p>
<div class="image">
<img src="images/DLToolkitArch.png"  align="center" alt="DLToolkit Architecture" width="50%"/>
</div>
<hr/>
<p> <a class="anchor" id="usage"></a> </p><h1>DLEnvironment Usage</h1>
<p>(<a href="#contents">Back to Contents</a>)</p>
<p>DLEnvironment requires a single JSON configuration file to configure a simulation. The service is initialized via a call to <code>deepRL::CreateService</code> with the path to configuration files, like:</p>
<p>```cpp deepRL::Service* servicePtr = deepRL::CreateService(jsonConfigPath); ```</p>
<p>and a subsequent call to initialize the service from a top-level JSON file, using:</p>
<p>```cpp servicePtr-&gt;SetupFromJsonFile(jsonFile); ```</p>
<p>JSON configuration files can reference other JSON configuration files, but note that the library assumes your files all live in the same directory (given by the <code>jsonConfigPath</code> argument to <code>CreateService</code> above).</p>
<p>The service will initialize AI instances from the JSON configuration as described below. Once created, AI instances and actions returned from the controlling neural network can be accessed via appropriate accessors from the top-level Service object. (see SimpleTrainingApp and AleApp in the same repo for worked examples).</p>
<p><a class="anchor" id="config"></a> </p><h1>DLEnvironment Configuration Files</h1>
<p>(<a href="#contents">Back to Contents</a>)</p>
<p>The system looks for a special configuration file in your configuration directory, named <code>Remote_Config.json</code>. If this file contains an empty JSON block, the service will load the local configuration file (the one passed to <code>SetupFromJsonFile</code> in the example above) and instantiate an internal neural network for RL control of the simulation (if configured to do so).</p>
<p>You can instead configure your environment for remote control via the DLBroker process by replacing the contents of Remote_Config.json with something like:</p>
<p>```javascript { "BrokerAddress" : "127.0.0.1:9505", "SimType" : "SimpleTrainingApp" }</p>
<p>```</p>
<p>The first line tells the environment to contact the broker on the localhost (on the loopback interface 127.0.0.1), on port 9505. The second is a tag by which this process will identify itself to the broker, which will be used by the broker to connect this process with an appropriate DLTrainer service. (This tag is arbitrary, but any DLTrainer wanting to process data from this environment should include the same tag in its list of recognized sims.)</p>
<p>An overview of the DLEnvironment service configuration is given below.</p>
<p>If the DLEnvironment process is to be controlled locally, the service configuration is sourced from a local version of the top-level configuration file.</p>
<p>If configured for control via the broker, the environment receives its configuration via the remote interface (i.e., from an appropriately configured DLTrainer service also connected to the DLBroker process), superseding any local JSON configuration files.</p>
<p>In either case, the same set of JSON configuration files can be used, with a few minor modifications indicated below where appropriate.</p>
<p><a class="anchor" id="service_config"></a> </p><h2>Service Configuration</h2>
<p>(<a href="#contents">Back to Contents</a>)</p>
<p>A top-level DLEnvironment configuration file might look something like this:</p>
<p>```javascript { "StateOutput": "StateOutput", "StatisticsOutput": "Statistics_Service",</p>
<p>"AIInstances": [ "Training_AIInstance.json" ],</p>
<p>"Experiment": "Experiment.json",</p>
<p>"ApplicationSettings": { "AreaSize": 5.0, "Speed": 0.5, "Distance": 3.0 } } ```</p>
<p>containing sections for defining AI instances, controlling the experiment, or configuring the application itself. See <a href="Documents/ConfigurationFiles/Service.json">Documents/ConfigurationFiles/Service.json</a> for detailed information on available options.</p>
<p><b>NB: When used with DLTrainer for remote training, the <code>AIInstances</code> keyword can be extended to allow specification of a neural network implementation to use for each AI, as in:</b></p>
<p>```javascript { "StateOutput": "", "StatisticsOutput": "Statistics_Service",</p>
<p>"AIInstances": [ { "Config":"Training_AIInstance.json", "Network": "mynetworkname" } ],</p>
<p>"Experiment": "Experiment.json",</p>
<p>"ApplicationSettings": { "AreaSize": 5.0, "Speed": 0.5, "Distance": 3.0 } ```</p>
<p>Here <code>mynetworkname</code> refers to a tag associated with a Python network implementation running in the trainer. If no network is specified, the trainer will use the default network (see DLTrainer docs for details on configuring the trainer).</p>
<p><a class="anchor" id="instance_config"></a> </p><h2>AI Instance Configuration</h2>
<p>(<a href="#contents">Back to Contents</a>)</p>
<p>The service config must at a minimum define an array of AI instances, via the <code>AIInstances</code> keyword, pointing to a configuration file for each instance. These files look something like the following:</p>
<p>```javascript { "AISubstance": "Training_AISubstance.json", "SelectAction": true, "UpdateNeuralNetwork": true, "StatisticsOutput": "Statistics_AIInstance", "ConvertedStateOutput": "Training_convertedState",</p>
<p>"ApplicationSettings": { } } ```</p>
<p>containing sections for defining AI actions, configuring an optional local neural network, outputting state and statistics about the AI instances, and application-specific settings. See <a href="Documents/ConfigurationFiles/AIInstance.json">Documents/ConfigurationFiles/AIInstance.json</a> for detailed information on available options.</p>
<p><b>NB: When used with DLTrainer for remote training, <code>SelectAction</code> and <code>UpdateNeuralNetwork</code> should both be set to <code>false</code>. This prevents instantiation and use of a local neural network.</b></p>
<p><a class="anchor" id="substance_config"></a> </p><h2>AI Substance Configuration</h2>
<p>(<a href="#contents">Back to Contents</a>)</p>
<p>The AI instance config must at a minimum define the AI actions, via the <code>AISubstance</code> keyword, pointing to a configuration file for the "substance" of this AI instance. These files look something like the following:</p>
<p>```javascript { "Inputs": [ { "Name": "target_location", "Shape": [ 1, 10, 10 ], "Type": "TopView", "AreaSize": [ 10.0, 10.0 ], "Channels": [ { "Name": "target0", "List": [ "/target/0/targetLocation" ] } ] }, { "Name": "ai_location", "Shape": [ 1, 10, 10 ], "Type": "TopView", "AreaSize": [ 10.0, 10.0 ], "Channels": [ { "Name": "AI", "List": [ "/ai/[id=$MYID]]/location" ] } ] } ], "Actions": [ [ "none", "up", "down", "left", "right" ] ], "Rewards": [ "/target/0/Reward" ], ... } ```</p>
<p>containing sections for defining state data associated with each AI instance, via the <code>Inputs</code> keyword, actions for each AI instance via the <code>Actions</code> keyword, and parameters configuring an optional local neural network implementation for this AI.</p>
<p>See <a href="Documents/ConfigurationFiles/AISubstance.json">Documents/ConfigurationFiles/AISubstance.json</a> for detailed information on available options. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jul 2 2018 10:26:35 for NVIDIA DeepLearning Dataset Synthesizer (NDDS) by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
